<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bible Viewer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Rubik', sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .verseSpan {
            font-weight: bold;
            color: #90c3fa;
            font-size: 12px;
        }

        .versionSpan {
            font-weight: bold;
            color: #1365bd;
        }

        #output {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #dee2e6;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        #output p {
             line-height: 1.8;
             font-size: 21px;
             word-spacing: 2px;
             letter-spacing: 0.3px;
             font-weight: 400;
             padding: 0 80px;
         }


    </style>
</head>

<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">Bible</h1>

        <form class="row g-3">
            <div class="col-md-4">
                <label for="version" class="form-label fw-bold">Select Version</label>
                <select id="versionID" class="form-select"></select>
            </div>

            <div class="col-md-4">
                <label for="book" class="form-label fw-bold">Select Book</label>
                <select id="bookID" class="form-select"></select>
            </div>

            <div class="col-md-4">
                <label for="chapter" class="form-label fw-bold">Select Chapter</label>
                <select id="chapterID" class="form-select"></select>
            </div>

            <div class="col-12 text-center">
                <button type="button" id="fetch" class="btn btn-dark">SUBMIT</button>
            </div>
        </form>

        <div id="output" class="mt-4">
            <p class="text-muted m-4 p-4 text-center">Selected content will appear here.</p>
        </div>
    </div>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js">
    </script>

    <script>
        const versionSelect = document.getElementById('versionID');
        const bookSelect = document.getElementById('bookID');
        const chapterSelect = document.getElementById('chapterID');
        const output = document.getElementById('output');
        const fetchButton = document.getElementById('fetch');

        // List of books for simplicity
        const books = [
            "genesis", "exodus", "leviticus", "numbers", "deuteronomy",
            "joshua", "judges", "ruth", "1-samuel", "2-samuel",
            "1-kings", "2-kings", "1-chronicles", "2-chronicles", "ezra",
            "nehemiah", "esther", "job", "psalms", "proverbs",
            "ecclesiastes", "song-of-songs", "isaiah", "jeremiah", "lamentations",
            "ezekiel", "daniel", "hosea", "joel", "amos",
            "obadiah", "jonah", "micah", "nahum", "habakkuk",
            "zephaniah", "haggai", "zechariah", "malachi",
            "matthew", "mark", "luke", "john", "acts",
            "romans", "1-corinthians", "2-corinthians", "galatians", "ephesians",
            "philippians", "colossians", "1-thessalonians", "2-thessalonians", "1-timothy",
            "2-timothy", "titus", "philemon", "hebrews", "james",
            "1-peter", "2-peter", "1-john", "2-john", "3-john", "jude", "revelation"
        ];

        // Load Bible versions
        async function loadVersions() {
            const response = await fetch('https://cdn.jsdelivr.net/gh/wldeh/bible-api/bibles/bibles.json');
            const versions = await response.json();
            versions.forEach(version => {
                const option = document.createElement('option');
                option.value = version.id;
                option.textContent = version.version;
                versionSelect.appendChild(option);
            });
        }

        // Populate books dropdown
        function populateBooks() {
            books.forEach(book => {
                const option = document.createElement('option');
                option.value = book.replace('-', '').toLowerCase();
                option.textContent = book.replace(/-/g, ' ').toUpperCase();
                bookSelect.appendChild(option);
            });
        }

        // Populate chapters dropdown
        function populateChapters() {
            chapterSelect.innerHTML = ''; // Clear previous options
            for (let i = 1; i <= 150; i++) { // Assuming a max of 150 chapters for simplicity
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                chapterSelect.appendChild(option);
            }
        }

        // Fetch selected chapter
        async function fetchChapter() {
            const version = versionSelect.value;
            const book = bookSelect.value;
            const chapter = chapterSelect.value;

            output.innerHTML = '<p class="text-muted mt-4 text-center">loading...</p>';

            if (!version || !book || !chapter) {
                output.innerHTML = '<p class="text-danger text-center m-4 p-4">Please select a version, book, and chapter.</p>';
                return;
            }

            console.log(version, book, chapter);

            const url = `https://cdn.jsdelivr.net/gh/wldeh/bible-api/bibles/${version}/books/${book}/chapters/${chapter}.json`;
            console.log(url);
            try {
                let headersList = {
                    "Accept": "*/*",
                    "User-Agent": "Chrome"
                }

                let response = await fetch(url, {
                    method: "GET",
                    headers: headersList
                });

                let data = await response.text();

                data = JSON.parse(data);
                chapters = data['data'];


                var innerHTML = '<h3 class="text-dark fw-bold text-center p-4">' + book.toUpperCase() + ' ' + chapter + '</h3><p>';

                chapters.forEach(ch => {
                    innerHTML += '<span class="verseSpan">' + ch['verse'] + '</span>' + ' ' + ch['text'] + '  ';
                });
                innerHTML += '</p>';
                output.innerHTML = innerHTML;
            } catch (error) {
                output.innerHTML = '<p class="text-danger text-center m-4 p-4">Error fetching chapter. Please try again.</p>';
            }
        }

        // Event listeners
        fetchButton.addEventListener('click', fetchChapter);

        // Initialize
        loadVersions();
        populateBooks();
        populateChapters();
    </script>
</body>

</html>